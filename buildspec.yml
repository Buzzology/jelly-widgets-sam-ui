version: 0.2

env:
  parameter-store:
      PARAMETER_STORE_NAME: $PARAMETER_STORE_NAME

phases:

  install:
    commands:
      - npm install    

  pre_build:
    commands:
      - echo "$PARAMETER_STORE_NAME" > .env
      - echo "$PARAMETER_STORE_NAME" > .env.production

  build:
    commands:
      - npm run-script build

  post_build:
    commands:
      - aws cloudfront create-invalidation --distribution-id=$DISTRIBUTION_ID --paths '/*'
      - aws cloudfront create-invalidation --distribution-id=$DISTRIBUTION_ID --paths '/*'
      
artifacts:
  files:
    - '**/*'
  base-directory: 'build'